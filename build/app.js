(()=>{const e=[{plan:"Arcade",planType:"Monthly",planTypeAbbrev:"mo",currency:"$",price:9},{plan:"Advanced",planType:"Monthly",planTypeAbbrev:"mo",currency:"$",price:12},{plan:"Pro",planType:"Monthly",planTypeAbbrev:"mo",currency:"$",price:15},{plan:"Arcade",planType:"Yearly",planTypeAbbrev:"yr",currency:"$",price:90},{plan:"Advanced",planType:"Yearly",planTypeAbbrev:"yr",currency:"$",price:120},{plan:"Pro",planType:"Yearly",planTypeAbbrev:"yr",currency:"$",price:150}],n=[{addOn:"Online service",planType:"Monthly",planTypeAbbrev:"mo",currency:"$",price:1},{addOn:"Larger storage",planType:"Monthly",planTypeAbbrev:"mo",currency:"$",price:2},{addOn:"Customizable profile",planType:"Monthly",planTypeAbbrev:"mo",currency:"$",price:2},{addOn:"Online service",planType:"Yearly",planTypeAbbrev:"yr",currency:"$",price:10},{addOn:"Larger storage",planType:"Yearly",planTypeAbbrev:"yr",currency:"$",price:20},{addOn:"Customizable profile",planType:"Yearly",planTypeAbbrev:"yr",currency:"$",price:20}],r={personalInfo:null,plan:null,addOns:[]},t={PERSONAL_INFO:"personalInfo",PLANS:"plans",ADD_ONS:"addOns",FINISHING_UP:"finishingUp",THANK_YOU:"thankYou"},a="subscription__step-number--selected",l="Arcade",c="Advanced",s="Pro",o="Monthly",p="Yearly",i="arcade-plan",d="advanced-plan",u="pro-plan",y={[l]:i,[c]:d,[s]:u},m="Online service",v="Larger storage",f="Customizable profile",b=Object.values(t),h={required:"This field is required",email:"Invalid email"},T="invalid-control",A="invalid-message";let g=0;const O={email:new RegExp("^[\\w-.]+@([\\w-]+\\.)+[\\w-]{2,4}$")},S=document.querySelector("#step"),$=document.querySelector("#stepContent"),q=document.querySelector(".subscription__step-navigator"),L=document.querySelector("#backStep"),E=Array.from($.children).map((e=>e.children)).map((e=>e[2])).filter((e=>e));for(const e of E)e.addEventListener("click",C);function C(e){const n=e.target.closest(".subscription__button");n&&(n.classList.contains("subscription__button--back")?k():n.classList.contains("subscription__button--next")&&_())}q.addEventListener("click",C);const k=()=>{0!==g&&(g--,0===g&&D(L,!1),G(),F(b[g]))},_=()=>{g!==b.length-1&&(j()||(g++,D(L,!0),F(b[g])))},x=()=>document.createElement("strong"),N=()=>document.createElement("span"),I=()=>document.createElement("div"),w=e=>{const n=Array.from(e.children).filter((e=>e.classList.contains("active")));for(const e of n)e.classList.remove("active")},Y=e=>{e.classList.remove("active")},M=e=>{e.classList.add("active")},P=()=>{if(g>3)return;(()=>{const e=Array.from(S.children).map((e=>e.children[0])).filter((e=>e.classList.contains(a)));for(const n of e)n.classList.remove(a)})();const e=`step${g+1}`;S.children[e].children[0].classList.add(a)},z=()=>{const e=Array.from($.children).filter((e=>"flex"===e.style.display||""===e.style.display));for(const n of e)n.style.display="none"},F=e=>{z(),$.children[e].style.display="flex",P()},D=(e,n)=>e.style.visibility=n?"visible":"hidden",R=document.querySelector("#basicInfoForm");for(const e of R.elements)e.addEventListener("keyup",(e=>{e.target.value?"email-address"!==e.target.id||O.email.test(e.target.value)?H(e.target):U(e.target,h.email):U(e.target,h.required)}));const U=(e,n)=>{const r=(e=>{const n=I(),r=N();return r.innerText=e,r.classList.add(A),n.append(r),n})(n),t=e.parentElement,a=t.querySelector("div");a&&t.removeChild(a),t.append(r),t.style.position="relative",e.classList.add(T)},H=e=>{e.classList.remove(T);const n=e.parentElement,r=n.querySelector("div");r&&n.removeChild(r)},j=()=>{let e=!1;switch(g){case 0:(e=>{for(const n of e)H(n)})(R.elements);const{required:n,email:t}=h,{name:a,emailAddress:l,phoneNumber:c}=R.elements;""===a.value&&U(a,n),""===l.value?U(l,n):O.email.test(l.value)||U(l,t),""===c.value&&U(c,n),e=!a.value||!l.value||!c.value,e||(r.personalInfo={name:a.value,emailAddress:l.value,phoneNumber:c.value},R.reset());break;case 1:e=!r.plan,e||(w(K),ae(),ne());break;case 2:le();break;case 3:q.style.display="none"}return e},G=()=>{switch(g){case 0:if(!r.personalInfo)return;const{name:e,emailAddress:n,phoneNumber:t}=r.personalInfo;R.elements.name.value=e,R.elements.emailAddress.value=n,R.elements.phoneNumber.value=t;break;case 1:if(!r.plan)return;const{plan:a}=r.plan,l=y[a],c=K.children[l];M(c);break;case 2:ne(),ae()}},K=document.querySelector(".subscription__step-card-plans"),B=document.querySelector("#switch-plan");K.addEventListener("click",(e=>{const n=e.target.closest(".subscription__step-card-plan");n&&(w(K),M(n),Q(n))})),B.addEventListener("change",(e=>{const n=document.querySelector("#arcade-plan-price"),t=document.querySelector("#advanced-plan-price"),a=document.querySelector("#pro-plan-price"),i=document.querySelectorAll(".free-plan-info");e.target.checked?(J(n,p,l),J(t,p,c),J(a,p,s),Array.from(i).forEach((e=>{e.classList.add("free-plan-info--shown")}))):(J(n,o,l),J(t,o,c),J(a,o,s),Array.from(i).forEach((e=>{e.classList.remove("free-plan-info--shown")}))),w(K),r.plan=null,r.addOns=[]}));const J=(n,r,t)=>{const a=e.filter((e=>e.planType===r)),{currency:l,price:c,planTypeAbbrev:s}=a.find((e=>e.plan===t));n.textContent=`${l}${c}/${s}`},Q=n=>{r.plan=null;const t=document.querySelector("#switch-plan").checked?p:o;switch(n.id){case i:r.plan=e.find((e=>e.plan===l&&e.planType===t));break;case d:r.plan=e.find((e=>e.plan===c&&e.planType===t));break;case u:r.plan=e.find((e=>e.plan===s&&e.planType===t))}},V=document.querySelector("#online-service"),W=document.querySelector("#larger-storage"),X=document.querySelector("#customizable-profile");V.addEventListener("change",(e=>{Z(e),ee(m,e)})),W.addEventListener("change",(e=>{Z(e),ee(v,e)})),X.addEventListener("change",(e=>{Z(e),ee(f,e)}));const Z=e=>{e.target.checked?M(e.target.parentElement):Y(e.target.parentElement)},ee=(e,t)=>{if(t.target.checked){const t=r.plan.planType,a=n.find((n=>n.addOn===e&&n.planType===t));r.addOns.some((n=>n.addOn===e))||r.addOns.push(a)}else r.addOns=r.addOns.filter((n=>n.addOn!==e))},ne=()=>{if(!r.plan)return;const{planType:e}=r.plan,n=document.querySelector("#online-service-price"),t=document.querySelector("#larger-storage-price"),a=document.querySelector("#customizable-profile-price");re(n,m,e),re(t,v,e),re(a,f,e)},re=(e,r,t)=>{const{currency:a,price:l,planTypeAbbrev:c}=n.find((e=>e.addOn===r&&e.planType===t));e.textContent=`${a}${l}/${c}`},te=(e,n)=>{let t=r.addOns.some((e=>e.addOn===n));t?(e.checked=t,M(e.parentElement)):(e.checked=!1,Y(e.parentElement))},ae=()=>{te(V,m),te(W,v),te(X,f)};document.querySelector("#change-selected-plan").addEventListener("click",(e=>{e.preventDefault(),g=1,G(),F(b[g])}));const le=()=>{(()=>{const e=document.querySelector("#selected-plan"),n=document.querySelector("#summary-price"),{plan:t,planType:a,currency:l,price:c,planTypeAbbrev:s}=r.plan;let o=x();o.textContent=`${t} (${a})`,e.childElementCount>0&&e.children[0].remove(),e.append(o),o=x(),o.textContent=`${l}${c}/${s}`,n.childElementCount>0&&n.firstChild.remove(),n.append(o)})(),(()=>{const e=document.querySelector(".subscription__summary-add-ons-selected");for(;e.firstChild;)e.removeChild(e.firstChild);for(const n of r.addOns){const{addOn:r,currency:t,price:a,planTypeAbbrev:l}=n,c=I(),s=N();s.textContent=r;const o=N();o.classList.add("price","price--summary"),o.textContent=`+${t}${a}/${l}`,c.append(s,o),e.append(c)}})(),(()=>{let e=0;e+=r.plan.price;const n=r.addOns.reduce(((e,n,r)=>e+n.price),0);e+=n;const{planType:t,currency:a,planTypeAbbrev:l}=r.plan,c=document.querySelector("#summary-total-name"),s=t===o?"month":"year";c.textContent=`Total (per ${s})`;const p=document.querySelector("#summary-total-price");p.firstChild&&p.removeChild(p.firstChild);const i=x();i.textContent=`${a}${e}/${l}`,p.append(i)})()};z(),$.children[t.PERSONAL_INFO].style.display="flex",g=0,P(),D(L,!1)})();